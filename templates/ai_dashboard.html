{% extends "base.html" %}

{% block title %}AIãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - RCCMè©¦é¨“å¯¾ç­–{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h1 class="text-center mb-4">
                ğŸ¤– AIå­¦ç¿’åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
            </h1>
        </div>
    </div>

    <!-- AIåˆ†æã‚µãƒãƒªãƒ¼ -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card border-primary">
                <div class="card-header bg-primary text-white">
                    <h4>ğŸ§  AIåˆ†æã‚µãƒãƒªãƒ¼</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="alert alert-info text-center">
                                <h5>å­¦ç¿’ã‚¹ã‚¿ã‚¤ãƒ«</h5>
                                <h3>ğŸ“ {{ analysis.learning_style or "åˆ†æä¸­..." }}</h3>
                                <small>ã‚ãªãŸã«æœ€é©ãªå­¦ç¿’æ–¹æ³•</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="alert alert-success text-center">
                                <h5>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬</h5>
                                <h3>ğŸ“ˆ {{ analysis.performance_prediction.score|default(0) }}%</h3>
                                <small>ç¾åœ¨ã®ç†è§£åº¦</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="alert alert-warning text-center">
                                <h5>æœ€é©å­¦ç¿’æ™‚é–“</h5>
                                <h3>ğŸ•°ï¸ {{ analysis.optimal_study_time or "è¨ˆç®—ä¸­..." }}</h3>
                                <small>åŠ¹ç‡çš„ãªå­¦ç¿’æ™‚é–“å¸¯</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼±ç‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-danger text-white">
                    <h5>âš ï¸ å¼±ç‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ</h5>
                </div>
                <div class="card-body">
                    {% if analysis.weakness_patterns %}
                        <ul class="list-group">
                            {% for pattern in analysis.weakness_patterns[:5] %}
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                {{ pattern.description }}
                                <span class="badge bg-danger rounded-pill">{{ pattern.frequency }}å›</span>
                            </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted">ã¾ã ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚å•é¡Œã‚’è§£ã„ã¦ãã ã•ã„ã€‚</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- è¨˜æ†¶å®šç€ç‡ -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5>ğŸ§  è¨˜æ†¶å®šç€ç‡åˆ†æ</h5>
                </div>
                <div class="card-body">
                    {% if analysis.memory_retention %}
                        <div class="progress mb-3" style="height: 30px;">
                            <div class="progress-bar bg-success" role="progressbar" 
                                 style="width: {{ analysis.memory_retention.retention_rate|default(0) }}%">
                                {{ analysis.memory_retention.retention_rate|default(0) }}%
                            </div>
                        </div>
                        <p>
                            <strong>å¹³å‡è¨˜æ†¶ä¿æŒæœŸé–“:</strong> {{ analysis.memory_retention.average_retention_days|default(0) }}æ—¥<br>
                            <strong>å¿˜å´æ›²ç·šã‚¿ã‚¤ãƒ—:</strong> {{ analysis.memory_retention.forgetting_curve_type|default("æ¨™æº–å‹") }}
                        </p>
                    {% else %}
                        <p class="text-muted">è¨˜æ†¶å®šç€ç‡ã‚’è¨ˆç®—ä¸­ã§ã™...</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- AIæ¨å¥¨äº‹é … -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card border-info">
                <div class="card-header bg-info text-white">
                    <h5>ğŸ’¡ AIå­¦ç¿’æ¨å¥¨äº‹é …</h5>
                </div>
                <div class="card-body">
                    {% if analysis.study_recommendations %}
                        <div class="row">
                            {% for rec in analysis.study_recommendations[:6] %}
                            <div class="col-md-4 mb-3">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h6 class="card-title">
                                            âœ… {{ rec.title }}
                                        </h6>
                                        <p class="card-text small">{{ rec.description }}</p>
                                        {% if rec.priority == "high" %}
                                        <span class="badge bg-danger">å„ªå…ˆåº¦ï¼šé«˜</span>
                                        {% elif rec.priority == "medium" %}
                                        <span class="badge bg-warning">å„ªå…ˆåº¦ï¼šä¸­</span>
                                        {% else %}
                                        <span class="badge bg-secondary">å„ªå…ˆåº¦ï¼šä½</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted">å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦æ¨å¥¨äº‹é …ã‚’ç”Ÿæˆã—ã¾ã™...</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
    <div class="row">
        <div class="col-md-12 text-center">
            <a href="/advanced_analytics" class="btn btn-primary btn-lg me-2">
                ğŸ“ˆ é«˜åº¦åˆ†æã‚’è¦‹ã‚‹
            </a>
            <a href="/statistics" class="btn btn-success btn-lg me-2">
                ğŸ“Š çµ±è¨ˆæƒ…å ±
            </a>
            <a href="/" class="btn btn-secondary btn-lg">
                ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
setInterval(function() {
    // AIã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
    $('.fa-robot').addClass('fa-spin');
    setTimeout(function() {
        $('.fa-robot').removeClass('fa-spin');
    }, 1000);
}, 5000);
</script>
{% endblock %}