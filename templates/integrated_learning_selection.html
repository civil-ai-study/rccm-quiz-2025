{% extends "base.html" %}

{% block title %}4-1åŸºç¤ã¨4-2å°‚é–€ã®é€£æºå­¦ç¿’ - RCCMè©¦é¨“å•é¡Œé›†{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>ğŸ”— é€£æºå­¦ç¿’ãƒ¢ãƒ¼ãƒ‰</h2>
                <div>
                    <a href="{{ url_for('departments') }}" class="btn btn-outline-secondary mr-2">
                        ğŸ¢ éƒ¨é–€é¸æŠ
                    </a>
                    <a href="{{ url_for('index') }}" class="btn btn-outline-primary">
                        ğŸ  ãƒ›ãƒ¼ãƒ 
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- é€£æºå­¦ç¿’ã®èª¬æ˜ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-info">
                <h5><i class="fas fa-info-circle"></i> é€£æºå­¦ç¿’ã¨ã¯ï¼Ÿ</h5>
                <p class="mb-0">
                    4-1åŸºç¤ç§‘ç›®ã§ã®ç†è§£åº¦ã«åŸºã¥ã„ã¦ã€4-2å°‚é–€ç§‘ç›®ã¸ã®å­¦ç¿’ã‚’æœ€é©åŒ–ã—ã¾ã™ã€‚
                    åŸºç¤ãŒã—ã£ã‹ã‚Šã—ã¦ã„ãªã„åˆ†é‡ã¯é‡ç‚¹çš„ã«å¾©ç¿’ã—ã€ç†è§£ãŒé€²ã‚“ã§ã„ã‚‹åˆ†é‡ã¯å°‚é–€ã¸ã¨æ®µéšçš„ã«é€²ã¿ã¾ã™ã€‚
                </p>
            </div>
        </div>
    </div>

    <!-- ç¾åœ¨ã®åŸºç¤ç†è§£åº¦è¡¨ç¤º -->
    {% if foundation_mastery is defined %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-primary">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-chart-bar"></i> ç¾åœ¨ã®åŸºç¤ç†è§£åº¦</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="text-center">
                                <h3 class="text-primary">{{ "%.1f"|format(foundation_mastery * 100) }}%</h3>
                                <p class="text-muted">4-1åŸºç¤ç§‘ç›®ã®ç¿’ç†Ÿåº¦</p>
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar 
                                        {% if foundation_mastery >= 0.7 %}bg-success
                                        {% elif foundation_mastery >= 0.4 %}bg-warning
                                        {% else %}bg-danger{% endif %}" 
                                         style="width: {{ foundation_mastery * 100 }}%">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>æ¨å¥¨å­¦ç¿’æ®µéš:</h6>
                            {% if foundation_mastery < 0.4 %}
                            <span class="badge badge-danger badge-lg">åŸºç¤æ§‹ç¯‰æ®µéš</span>
                            <p class="small text-muted mt-2">4-1åŸºç¤ç§‘ç›®ã®å¾¹åº•çš„ãªå­¦ç¿’ãŒå¿…è¦ã§ã™</p>
                            {% elif foundation_mastery < 0.7 %}
                            <span class="badge badge-warning badge-lg">æ©‹æ¸¡ã—å­¦ç¿’æ®µéš</span>
                            <p class="small text-muted mt-2">åŸºç¤ã®å¼·åŒ–ã¨å°‚é–€ã¸ã®å°å…¥ã‚’ä¸¦è¡Œã—ã¦è¡Œã„ã¾ã™</p>
                            {% elif foundation_mastery < 0.85 %}
                            <span class="badge badge-info badge-lg">å°‚é–€é€²æ­©æ®µéš</span>
                            <p class="small text-muted mt-2">4-2å°‚é–€ç§‘ç›®ã‚’ä¸­å¿ƒã«å­¦ç¿’ã‚’é€²ã‚ã¾ã™</p>
                            {% else %}
                            <span class="badge badge-success badge-lg">çµ±åˆç¿’ç†Ÿæ®µéš</span>
                            <p class="small text-muted mt-2">é«˜åº¦ãªå°‚é–€å•é¡Œã§å®Ÿè·µåŠ›ã‚’é¤Šã„ã¾ã™</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰é¸æŠ -->
    <div class="row mb-4">
        <div class="col-12">
            <h4 class="mb-3">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„</h4>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="card h-100 border-success">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-arrow-right"></i> åŸºç¤â†’å°‚é–€é€£æºå­¦ç¿’
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text">
                                åŸºç¤ç†è§£åº¦ã«å¿œã˜ã¦4-1ã‹ã‚‰4-2ã¸ã®æ®µéšçš„å­¦ç¿’ã‚’è¡Œã„ã¾ã™ã€‚
                                ç¿’ç†Ÿåº¦ã«åˆã‚ã›ã¦å•é¡Œã®é…åˆ†ã‚’å‹•çš„ã«èª¿æ•´ã—ã¾ã™ã€‚
                            </p>
                            <ul class="list-unstyled small">
                                <li><i class="fas fa-check text-success"></i> ç¿’ç†Ÿåº¦ãƒ™ãƒ¼ã‚¹ã®é€²è¡Œ</li>
                                <li><i class="fas fa-check text-success"></i> æ®µéšçš„é›£æ˜“åº¦èª¿æ•´</li>
                                <li><i class="fas fa-check text-success"></i> å¼±ç‚¹åˆ†é‡ã®é‡ç‚¹å¼·åŒ–</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            {% if department %}
                            <a href="{{ url_for('integrated_learning', mode='basic_to_specialist', department=department) }}" 
                               class="btn btn-success btn-block">
                                <i class="fas fa-play"></i> ã“ã®æ–¹å¼ã§å­¦ç¿’é–‹å§‹
                            </a>
                            {% else %}
                            <a href="{{ url_for('integrated_learning', mode='basic_to_specialist') }}" 
                               class="btn btn-success btn-block">
                                <i class="fas fa-play"></i> ã“ã®æ–¹å¼ã§å­¦ç¿’é–‹å§‹
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-3">
                    <div class="card h-100 border-warning">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0">
                                <i class="fas fa-building"></i> åŸºç¤å¼·åŒ–å­¦ç¿’
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text">
                                4-1åŸºç¤ç§‘ç›®ã‚’é‡ç‚¹çš„ã«å¼·åŒ–ã—ã€å°‚é–€å­¦ç¿’ã¸ã®åœŸå°ã‚’å›ºã‚ã¾ã™ã€‚
                                åŸºç¤ãŒä¸å®‰ãªæ–¹ã«ãŠã™ã™ã‚ã§ã™ã€‚
                            </p>
                            <ul class="list-unstyled small">
                                <li><i class="fas fa-check text-warning"></i> åŸºç¤é‡è¦–ï¼ˆ60%ä»¥ä¸Šï¼‰</li>
                                <li><i class="fas fa-check text-warning"></i> æ©‹æ¸¡ã—å­¦ç¿’</li>
                                <li><i class="fas fa-check text-warning"></i> æ®µéšçš„å°‚é–€å°å…¥</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            {% if department %}
                            <a href="{{ url_for('integrated_learning', mode='foundation_reinforced', department=department) }}" 
                               class="btn btn-warning btn-block">
                                <i class="fas fa-play"></i> ã“ã®æ–¹å¼ã§å­¦ç¿’é–‹å§‹
                            </a>
                            {% else %}
                            <a href="{{ url_for('integrated_learning', mode='foundation_reinforced') }}" 
                               class="btn btn-warning btn-block">
                                <i class="fas fa-play"></i> ã“ã®æ–¹å¼ã§å­¦ç¿’é–‹å§‹
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- éƒ¨é–€åˆ¥å­¦ç¿’ã®ãƒ¡ãƒªãƒƒãƒˆ -->
    {% if department %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-light border">
                <h6><i class="fas fa-lightbulb text-warning"></i> 
                    {{ departments.get(department, {}).get('name', department) }}éƒ¨é–€ã§ã®é€£æºå­¦ç¿’</h6>
                <p class="mb-0 small">
                    ã“ã®éƒ¨é–€ã®åŸºç¤ã‚«ãƒ†ã‚´ãƒªï¼ˆ
                    {% if department in department_patterns %}
                        {% for cat in department_patterns[department]['foundation_categories'] %}
                            {{ cat }}{% if not loop.last %}ã€{% endif %}
                        {% endfor %}
                    {% else %}
                        æ§‹é€ åŠ›å­¦ã€ææ–™å·¥å­¦ãªã©
                    {% endif %}
                    ï¼‰ã®ç†è§£åº¦ã«åŸºã¥ã„ã¦ã€å°‚é–€åˆ†é‡ï¼ˆ
                    {% if department in department_patterns %}
                        {% for cat in department_patterns[department]['application_categories'] %}
                            {{ cat }}{% if not loop.last %}ã€{% endif %}
                        {% endfor %}
                    {% else %}
                        è¨­è¨ˆã€æ–½å·¥ã€ç¶­æŒç®¡ç†ãªã©
                    {% endif %}
                    ï¼‰ã¸ã®å­¦ç¿’ã‚’æœ€é©åŒ–ã—ã¾ã™ã€‚
                </p>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- å­¦ç¿’åŠ¹æœã®èª¬æ˜ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-chart-line text-info"></i> é€£æºå­¦ç¿’ã®åŠ¹æœ</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <i class="fas fa-graduation-cap fa-3x text-primary mb-3"></i>
                            <h6>ç†è§£åº¦å‘ä¸Š</h6>
                            <p class="small text-muted">åŸºç¤ã‚’å›ºã‚ã¦ã‹ã‚‰å°‚é–€ã«é€²ã‚€ã“ã¨ã§ã€ã‚ˆã‚Šæ·±ã„ç†è§£ãŒå¾—ã‚‰ã‚Œã¾ã™</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <i class="fas fa-target fa-3x text-success mb-3"></i>
                            <h6>åŠ¹ç‡çš„å­¦ç¿’</h6>
                            <p class="small text-muted">å¼±ç‚¹ã‚’é‡ç‚¹çš„ã«å­¦ç¿’ã—ã€å¼·ã¿ã¯ç¶­æŒã™ã‚‹ã“ã¨ã§åŠ¹ç‡ãŒå‘ä¸Šã—ã¾ã™</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <i class="fas fa-trophy fa-3x text-warning mb-3"></i>
                            <h6>åˆæ ¼ç‡å‘ä¸Š</h6>
                            <p class="small text-muted">æ®µéšçš„ãªå­¦ç¿’ã«ã‚ˆã‚Šã€ç¢ºå®ŸãªçŸ¥è­˜å®šç€ã¨åˆæ ¼ç‡å‘ä¸ŠãŒæœŸå¾…ã§ãã¾ã™</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <div class="row">
        <div class="col-12 text-center">
            <div class="btn-group" role="group">
                <a href="{{ url_for('adaptive_quiz') }}" class="btn btn-outline-secondary">
                    <i class="fas fa-brain"></i> é€šå¸¸ã®AIå­¦ç¿’
                </a>
                <a href="{{ url_for('ai_analysis') }}" class="btn btn-outline-info">
                    <i class="fas fa-chart-bar"></i> å¼±ç‚¹åˆ†æ
                </a>
                <a href="{{ url_for('department_statistics') }}" class="btn btn-outline-primary">
                    <i class="fas fa-chart-line"></i> è©³ç´°çµ±è¨ˆ
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.badge-lg {
    font-size: 1rem;
    padding: 0.5rem 1rem;
}

.card-footer .btn {
    font-weight: bold;
}

.progress {
    border-radius: 10px;
}

.alert-light {
    background-color: #f8f9fa;
    border-color: #dee2e6;
}
</style>
{% endblock %}