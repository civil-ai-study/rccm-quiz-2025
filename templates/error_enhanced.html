<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ | RCCMå­¦ç¿’ã‚¢ãƒ—ãƒª</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome removed to prevent â–¡ character display issues -->
    <style>
        .error-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .error-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            max-width: 600px;
            overflow: hidden;
        }
        .error-header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 3rem 2rem 2rem;
            text-align: center;
        }
        .error-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        .error-body {
            padding: 2rem;
        }
        .solution-card {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 1rem;
            margin: 1rem 0;
        }
        .quick-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="error-card">
            <div class="error-header">
                <div class="error-icon">
                    âš ï¸
                </div>
                <h1>ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“</h1>
                <p class="mb-0">äºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p>
            </div>
            
            <div class="error-body">
                <div class="text-center mb-4">
                    <h5>ä½•ãŒèµ·ããŸã®ã§ã™ã‹ï¼Ÿ</h5>
                    <p class="text-muted">
                        {% if error_message %}
                            {{ error_message }}
                        {% else %}
                            ã‚·ã‚¹ãƒ†ãƒ ã®ä¸€æ™‚çš„ãªå•é¡Œã«ã‚ˆã‚Šã€ãƒšãƒ¼ã‚¸ã‚’æ­£å¸¸ã«è¡¨ç¤ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚
                        {% endif %}
                    </p>
                </div>

                <div class="solution-card">
                    <h6>ğŸ’¡ è§£æ±ºæ–¹æ³•</h6>
                    <ul class="mb-0">
                        <li>ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°ã—ã¦ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„</li>
                        <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãã ã•ã„</li>
                        <li>ã—ã°ã‚‰ãæ™‚é–“ã‚’ç½®ã„ã¦ã‹ã‚‰å†åº¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„</li>
                        <li>å•é¡ŒãŒç¶šãå ´åˆã¯ã€ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãŠè©¦ã—ãã ã•ã„</li>
                    </ul>
                </div>

                <div class="text-center">
                    <small class="text-muted">
                        â„¹ï¸
                        ã‚¨ãƒ©ãƒ¼ID: {{ error_id or 'RCCM-' + timestamp or 'ä¸æ˜' }}
                    </small>
                </div>

                <div class="quick-actions">
                    <a href="/" class="btn btn-primary">
                        ğŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
                    </a>
                    <button onclick="location.reload()" class="btn btn-outline-secondary">
                        ğŸ”„ ãƒšãƒ¼ã‚¸æ›´æ–°
                    </button>
                    <button onclick="history.back()" class="btn btn-outline-info">
                        â¬…ï¸ å‰ã®ãƒšãƒ¼ã‚¸
                    </button>
                    <a href="/help" class="btn btn-outline-success">
                        â“ ãƒ˜ãƒ«ãƒ—
                    </a>
                </div>

                <div class="mt-4 text-center">
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-sm btn-outline-warning" onclick="reportError()">
                            ğŸ› ã‚¨ãƒ©ãƒ¼å ±å‘Š
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-info" onclick="copyErrorInfo()">
                            ğŸ“‹ ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚³ãƒ”ãƒ¼
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function reportError() {
            const errorInfo = {
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                url: window.location.href,
                error: '{{ error_message | default("æœªçŸ¥ã®ã‚¨ãƒ©ãƒ¼") | escape }}',
                errorId: '{{ error_id or "ä¸æ˜" }}'
            };
            
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã«ã‚¨ãƒ©ãƒ¼å ±å‘Šã‚’é€ä¿¡
            alert('ã‚¨ãƒ©ãƒ¼å ±å‘Šæ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™ã€‚\n\nä¸€æ™‚çš„ãªè§£æ±ºç­–:\n1. ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°ã—ã¦ãã ã•ã„\n2. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãã ã•ã„\n3. ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„');
        }

        function copyErrorInfo() {
            const errorInfo = `
RCCMå­¦ç¿’ã‚¢ãƒ—ãƒª ã‚¨ãƒ©ãƒ¼æƒ…å ±
========================
æ™‚åˆ»: ${new Date().toLocaleString('ja-JP')}
ã‚¨ãƒ©ãƒ¼ID: {{ error_id or "ä¸æ˜" }}
URL: ${window.location.href}
ãƒ–ãƒ©ã‚¦ã‚¶: ${navigator.userAgent}
ã‚¨ãƒ©ãƒ¼å†…å®¹: {{ error_message | default("æœªçŸ¥ã®ã‚¨ãƒ©ãƒ¼") | escape }}
            `.trim();
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(errorInfo).then(() => {
                    alert('ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚\nç®¡ç†è€…ã¸ã®å ±å‘Šã«ã”åˆ©ç”¨ãã ã•ã„ã€‚');
                });
            } else {
                alert('ã‚¨ãƒ©ãƒ¼æƒ…å ±:\n\n' + errorInfo);
            }
        }

        // è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        let retryCount = 0;
        function autoRetry() {
            if (retryCount < 2 && performance.navigation.type !== 1) { // ãƒªãƒ­ãƒ¼ãƒ‰ã§ãªã„å ´åˆã®ã¿
                retryCount++;
                setTimeout(() => {
                    location.reload();
                }, 3000);
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒªãƒˆãƒ©ã‚¤ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
        window.addEventListener('load', function() {
            if (performance.navigation.type === 1) { // ãƒªãƒ­ãƒ¼ãƒ‰ã®å ´åˆ
                retryCount = 0;
            }
        });
    </script>
</body>
</html>