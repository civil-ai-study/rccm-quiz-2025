{% extends 'base.html' %}
{% block title %}{{ department.name }}éƒ¨é–€å­¦ç¿’ | RCCMè©¦é¨“å•é¡Œé›†{% endblock %}
{% block content %}
<div class="container my-4">
  <!-- éƒ¨é–€ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="text-center mb-4">
    <div class="d-flex align-items-center justify-content-center mb-3">
      <a href="/" class="btn btn-outline-secondary me-3">
        â¬…ï¸ ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
      </a>
      <h1 class="mb-0">
        <i class="{{ department.icon }} me-2"></i>{{ department.name }}éƒ¨é–€
      </h1>
    </div>
    <p class="text-muted">{{ department.description }}</p>
  </div>

  <!-- å­¦ç¿’é€²æ—ã‚µãƒãƒªãƒ¼ -->
  <div class="row mb-4">
    <div class="col-md-8 mx-auto">
      <div class="card border-primary">
        <div class="card-header text-white text-center" style="background-color: var(--primary-color)">
          <h5 class="mb-0">ğŸ“Š {{ department.name }}éƒ¨é–€ å°‚é–€ç§‘ç›®å­¦ç¿’é€²æ—</h5>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-4">
              <div class="h3 text-primary">{{ specialist_stats.total_questions }}</div>
              <small class="text-muted">å•é¡Œæ•°</small>
            </div>
            <div class="col-4">
              <div class="h3 text-warning">{{ specialist_stats.answered }}</div>
              <small class="text-muted">è§£ç­”æ¸ˆã¿</small>
            </div>
            <div class="col-4">
              <div class="h3 text-success">{{ "%.1f"|format(specialist_stats.accuracy) }}%</div>
              <small class="text-muted">æ­£ç­”ç‡</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 4-2 å°‚é–€ç§‘ç›® ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div class="row mb-4">
    <div class="col-md-10 mx-auto">
      <div class="card border-success">
        <div class="card-header text-white" style="background-color: var(--success-color)">
          <h5 class="mb-0">
            âš™ï¸ 4-2 å°‚é–€ç§‘ç›® - {{ department.name }}éƒ¨é–€
          </h5>
          <small>{{ department.name }}éƒ¨é–€å°‚é–€å•é¡Œ</small>
        </div>
        <div class="card-body">
          <!-- é€²æ—ãƒãƒ¼ -->
          <div class="mb-4">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span><strong>å­¦ç¿’é€²æ—</strong></span>
              <span class="text-success"><strong>{{ (specialist_stats.answered / specialist_stats.total_questions * 100)|round(1) if specialist_stats.total_questions > 0 else 0 }}%</strong></span>
            </div>
            <div class="progress" style="height: 12px;">
              <div class="progress-bar bg-success" 
                   style="width: {{ (specialist_stats.answered / specialist_stats.total_questions * 100) if specialist_stats.total_questions > 0 else 0 }}%"></div>
            </div>
          </div>
          
          <!-- å­¦ç¿’ãƒœã‚¿ãƒ³ -->
          <div class="row g-3">
            {% if (department.id == 'basic' and basic_stats.total_questions > 0) or (department.id != 'basic' and specialist_stats.total_questions > 0) %}
              <div class="col-md-6">
                <!-- ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œãƒœã‚¿ãƒ³ -->
                <a href="/exam?department={{ department.name }}&type=specialist" 
                   class="btn btn-success btn-lg w-100">
                  ğŸ² ãƒ©ãƒ³ãƒ€ãƒ å­¦ç¿’ï¼ˆ2011-2019å¹´å…¨å•é¡Œï¼‰
                </a>
              </div>
              
              <div class="col-md-6">
                <!-- å¹´åº¦åˆ¥å­¦ç¿’ãƒœã‚¿ãƒ³ -->
                <button class="btn btn-outline-success btn-lg w-100" type="button" data-bs-toggle="collapse" 
                        data-bs-target="#yearSelection" aria-expanded="false" aria-controls="yearSelection">
                  ğŸ“… å¹´åº¦åˆ¥éå»å•ã‚’é¸æŠ
                  â–¼
                </button>
              </div>
              
              <!-- å¹´åº¦é¸æŠï¼ˆæŠ˜ã‚ŠãŸãŸã¿ï¼‰ -->
              <div class="col-12">
                <div class="collapse mt-2" id="yearSelection">
                  <div class="card card-body">
                    <h6 class="mb-3">ğŸ“œ éå»å•å¹´åº¦é¸æŠ</h6>
                    <div class="row g-2">
                      {% for year in range(2019, 2007, -1) %}
                      <div class="col-md-3 col-6">
                        <a href="/exam?department={{ department.name }}&type=specialist&year={{ year }}" 
                           class="btn btn-sm btn-outline-primary w-100">
                          ğŸ“„ {{ year }}å¹´åº¦
                        </a>
                      </div>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
              
            {% else %}
              <div class="col-12">
                <div class="alert alert-info mb-0">
                  â„¹ï¸
                  ã“ã®éƒ¨é–€ã®å°‚é–€å•é¡Œã¯ã¾ã åˆ©ç”¨ã§ãã¾ã›ã‚“
                </div>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- å¾©ç¿’ãƒ»ãã®ä»–ã®æ©Ÿèƒ½ -->
  <div class="row mt-4">
    <div class="col-md-8 mx-auto">
      <div class="card border-info">
        <div class="card-header bg-info text-white">
          <h5 class="mb-0">ğŸ› ï¸ å­¦ç¿’æ”¯æ´æ©Ÿèƒ½</h5>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-4">
              <a href="/review?department={{ department.name }}" 
                 class="btn btn-info w-100">
                ğŸ”–
                <div><strong>å¾©ç¿’ãƒªã‚¹ãƒˆ</strong></div>
                <small class="d-block">é–“é•ãˆãŸå•é¡Œ ({{ review_count }}å•)</small>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/adaptive_quiz?department={{ department.name }}" 
                 class="btn btn-outline-info w-100">
                ğŸ§ 
                <div><strong>AIé©å¿œå­¦ç¿’</strong></div>
                <small class="d-block">æœ€é©ãªå•é¡Œã‚’è‡ªå‹•é¸æŠ</small>
              </a>
            </div>
            <div class="col-md-4">
              <a href="/statistics?department={{ department.name }}" 
                 class="btn btn-outline-info w-100">
                ğŸ“ˆ
                <div><strong>è©³ç´°çµ±è¨ˆ</strong></div>
                <small class="d-block">éƒ¨é–€åˆ¥æˆç¸¾ç¢ºèª</small>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- éƒ¨é–€å­¦ç¿’ã®ãƒ’ãƒ³ãƒˆ -->
  <div class="row mt-4">
    <div class="col-md-10 mx-auto">
      <div class="alert alert-light border">
        <h6>ğŸ’¡ {{ department.name }}éƒ¨é–€ åŠ¹æœçš„ãªå­¦ç¿’ã®ãƒ’ãƒ³ãƒˆ</h6>
        <ul class="mb-0">
          <li><strong>å°‚é–€ç§‘ç›®é›†ä¸­ï¼š</strong> {{ department.name }}éƒ¨é–€ã«ç‰¹åŒ–ã—ãŸå†…å®¹ã‚’é‡ç‚¹çš„ã«å­¦ç¿’</li>
          <li><strong>å¹´åº¦åˆ¥å­¦ç¿’ï¼š</strong> éå»å•ã‚’å¹´åº¦åˆ¥ã«è§£ã„ã¦å‡ºé¡Œå‚¾å‘ã‚’æŠŠæ¡</li>
          <li><strong>ãƒ©ãƒ³ãƒ€ãƒ å­¦ç¿’ï¼š</strong> å…¨å¹´åº¦ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦å®ŸåŠ›ãƒ†ã‚¹ãƒˆ</li>
          <li><strong>å¾©ç¿’å¾¹åº•ï¼š</strong> é–“é•ãˆãŸå•é¡Œã¯å¾©ç¿’ãƒªã‚¹ãƒˆã§ç¢ºå®Ÿã«ç†è§£ã‚’æ·±ã‚ã‚‹</li>
          <li><strong>åŸºç¤ç§‘ç›®ï¼š</strong> ãƒ›ãƒ¼ãƒ ç”»é¢ã‹ã‚‰4-1åŸºç¤ç§‘ç›®ã‚‚ä¸¦è¡Œã—ã¦å­¦ç¿’æ¨å¥¨</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<style>
.card {
  transition: transform 0.2s ease;
}

.card:hover {
  transform: translateY(-2px);
}

.progress {
  border-radius: 10px;
}

.btn {
  transition: all 0.3s ease;
}

.btn:hover {
  transform: translateY(-2px);
}
</style>
{% endblock %}